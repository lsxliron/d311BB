define(["d3","jquery","pnotify"],function(e,t,n){return{wrap:function(t,n){t.each(function(){var t=e.select(this),r=t.text().split(/\s+/).reverse(),i,s=[],o=0,u=1.1,a=t.attr("y"),f=parseFloat(t.attr("dy")),l=t.text(null).append("tspan").attr("x",0).attr("y",a).attr("dy",f+"em");while(i=r.pop())s.push(i),l.text(s.join(" ")),l.node().getComputedTextLength()>n&&(s.pop(),l.text(s.join(" ")),s=[i],l=t.append("tspan").attr("x",1).attr("y",a).attr("dy",++o*u+f+"em").text(i))})},updateSelectedBoroughs:function(){var n=[],r=[];t.each(t('#regionsDropdown > ul > li > input[type="checkbox"]'),function(e,t){t.checked&&n.push("."+t.id.slice(0,2))}),app.vents.trigger("clearMap"),t.each(n,function(t,n){e.selectAll(n).each(function(e){r.push(e.properties.BoroCT2010.toString())})}),app.vents.trigger("boroughSelected",{selectedPaths:r})},updateInfoPanel:function(e,n,r,i){t("#numOfRegions")[0].innerHTML=e,t("#regionPercentage")[0].innerHTML=n,t("#populationValue")[0].innerHTML=r,t("#complaintPercentage")[0].innerHTML=i},init:function(e){var n=this;t("#applyBoroughs").on("click",function(){return n.updateSelectedBoroughs()}),t("#applyGraph").on("click",function(){return n.generateNewParCoor()}),t("#applyMatrix").on("click",function(){return n.generateNewSplom()});for(var r in e)t("#matrixDropdown > .dropdown-menu").append('<li><input type="checkbox" id='+r+" /> <label>"+e[r]+"</label></li>"),t("#graphDropdown > .dropdown-menu").append('<li><input type="checkbox" id='+r+" /> <label>"+e[r]+"</label></li>")},loadDataFieldNames:function(){var e={};return t.ajax({dataType:"json",async:!1,url:"data/field_names.json",success:function(t){for(var n in t)e[n]=t[n]}}),e},generateNewParCoor:function(){var e=[];t.each(t('#graphDropdown > .dropdown-menu > li > input[type="checkbox"'),function(t,n){n.checked&&e.push(n.id)}),e.length<2||e.length>10?new n({title:"Too many fields selected!",text:"Please choose up to 10 fields",type:"error",animate_speed:"slow",animation:"fade",delay:3e3,shadow:!0,mouse_reset:!0}):app.vents.trigger("updateParCoorFields",{fields:e})},generateNewSplom:function(){var e=[];t.each(t('#matrixDropdown > .dropdown-menu > li > input[type="checkbox"'),function(t,n){n.checked&&e.push(n.id)}),e.length!=3?new n({title:"Too many fields selected!",text:"Please exactly 3 fields",type:"error",animate_speed:"slow",animation:"fade",delay:3e3,shadow:!0,mouse_reset:!0}):app.vents.trigger("updateSplomFields",{fields:e})}}});